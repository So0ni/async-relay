# TCP/UDP Relay Configuration

services:
  # Web proxy example - forwards both TCP and UDP on port 8080
  - name: "web-proxy"
    protocol: "both"     # tcp, udp, or both (default: both)
    listen:
      address: "::"      # IPv6 address (also accepts IPv4)
      port: 8080
    backends:
      - "example.com:80"           # Domain name (resolved every hour)
      - "192.168.1.10:80"          # IPv4 address
      - "[2001:db8::1]:80"         # IPv6 address
      - "backup.example.com:80"    # Backup domain
    backend_cooldown: 1800  # Cooldown period in seconds after 2nd failure (default: 1800 = 30 min)
    health_check:        # Proactive health check (optional, only for TCP services)
      enabled: true      # Enable health check (default: false)
      interval: 60       # Check interval in seconds (default: 60)
      timeout: 5         # TCP connection timeout in seconds (default: 5)

  # DNS forwarder example - UDP only
  - name: "dns-forward"
    protocol: "udp"      # Only forward UDP traffic
    listen:
      address: "0.0.0.0"  # IPv4 wildcard
      port: 53
    backends:
      - "dns.google:53"
      - "8.8.8.8:53"
      - "8.8.4.4:53"
    backend_cooldown: 300  # 5 minutes cooldown for DNS (faster recovery)

  # HTTPS proxy example - TCP only with health check
  - name: "https-proxy"
    protocol: "tcp"      # Only forward TCP traffic
    listen:
      address: "::"
      port: 8443
    backends:
      - "secure.example.com:443"
      - "backup.example.com:443"
    # backend_cooldown not specified, will use default (1800s)
    health_check:        # Health check enabled for TCP service
      enabled: true
      interval: 30       # More frequent checks for critical service
      timeout: 3
